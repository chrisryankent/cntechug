<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Donation Payment Page</title>
        <link rel="stylesheet" href="css/bootstrap.min.css" />
        <link rel="stylesheet" href="styles/index.css" />
        <link rel="stylesheet" href="css/font-awesome.min.css" />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
        />
        <style>
            body {
                font-family: "Arial", sans-serif;
                background-color: #f8f9fa;
                color: #343a40;
            }
            header {
                background-color: #007bff;
                color: white;
                padding: 1rem 0;
                text-align: center;
            }
            header h1 {
                margin: 0;
                font-size: 2.5rem;
            }
            .container {
                max-width: 700px;
                margin: 2rem auto;
                padding: 2rem;
                background-color: white;
                border-radius: 8px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            }
            h2 {
                text-align: center;
                margin-bottom: 1.5rem;
            }
            .form-group {
                margin-bottom: 1.5rem;
            }
            .form-group label {
                display: block;
                margin-bottom: 0.5rem;
            }
            .form-group input,
            .form-group select {
                width: 100%;
                padding: 0.75rem;
                border: 1px solid #ced4da;
                border-radius: 4px;
            }
            .cta-button {
                display: block;
                width: 100%;
                background-color: #28a745;
                color: white;
                padding: 1rem;
                border: none;
                border-radius: 4px;
                font-size: 1.2rem;
                cursor: pointer;
                text-align: center;
            }
            .cta-button:hover {
                background-color: #218838;
            }
            .payment-details {
                display: none;
            }
           
        </style>
    </head>
    <body>
      
         <nav class="navbar navbar-expand-lg navbar-light bg-dark fixed-top">
              <a class="navbar-brand text-primary" href="index.html">CN-TECH</a>
              <button class="navbar-toggler bg-primary" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarNav">
                  <ul class="navbar-nav ml-auto">
                      <li class="nav-item">
                          <a class="nav-link text-primary active" href="index.html" title="Home">Home</a>
                      </li>
                      <li class="nav-item">
                          <a class="nav-link text-primary" href="contact us.html" title="Contact Us">Contact Us</a>
                      </li>
                      <li class="nav-item">
                          <a class="nav-link text-primary" href="about.html" title="About">About</a>
                      </li>
                      <li class="nav-item">
                          <a class="nav-link text-primary" href="blog.html" title="Blog">Blog</a>
                      </li>
                      <li class="nav-item">
                          <a href="donate.html" class="btn btn-sm btn-outline-primary">Donate</a>
                      </li>
                  </ul>
              </div>
          </nav>

        <header class="mt-5">
            <h1>Complete Your Donation</h1>
        </header>

        <div class="container mt-5 pt-5">
            <h2>Donation Details</h2>
            <form id="donation-form" action="#" method="post">
                <div class="form-group">
                    <label for="name">Full Name</label>
                    <input type="text" id="name" name="name" required />
                </div>
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" name="email" required />
                </div>
                <div class="form-group">
                    <label for="amount">Donation Amount</label>
                    <input type="number" id="amount" name="amount" required />
                </div>
                <div class="form-group">
                    <label for="payment-method">Payment Method</label>
                    <select id="payment-method" name="payment-method" required>
                        <option value="">Select a method</option>
                        <option value="credit-card">Credit Card</option>
                        <option value="paypal">PayPal</option>
                        <option value="bank-transfer">Bank Transfer</option>
                        <option value="mobile-money">Mobile Money</option>
                    </select>
                </div>
                <div id="credit-card-details" class="payment-details">
                    <div class="form-group">
                        <label for="cc-number">Credit Card Number</label>
                        <input type="text" id="cc-number" name="cc-number" />
                    </div>
                    <div class="form-group">
                        <label for="cc-expiry">Expiry Date (MM/YY)</label>
                        <input type="text" id="cc-expiry" name="cc-expiry" />
                    </div>
                    <div class="form-group">
                        <label for="cc-cvc">CVC</label>
                        <input type="text" id="cc-cvc" name="cc-cvc" />
                    </div>
                </div>
                <div id="paypal-details" class="payment-details">
                    <p>
                        You will be redirected to PayPal to complete your
                        donation.
                    </p>
                </div>
                <div id="bank-transfer-details" class="payment-details">
                    <p>
                        Please transfer the donation amount to the following
                        bank account:
                    </p>
                    <p>Account Name: Hospital Donation Account</p>
                    <p>Account Number: 123456789</p>
                    <p>Bank: Example Bank</p>
                    <p>SWIFT/BIC: EXAMPLE123</p>
                </div>
                <div id="mobile-money-details" class="payment-details">
                    <div class="form-group">
                        <label for="phone-number"
                            >Mobile Money Phone Number</label
                        >
                        <input
                            type="text"
                            id="phone-number"
                            name="phone-number"
                        />
                    </div>
                    <div class="form-group">
                        <label for="recipient-number"
                            >Recipient Mobile Money Number</label
                        >
                        <input
                            type="text"
                            id="recipient-number"
                            name="recipient-number"
                            value="+256772024523"
                            readonly
                        />
                    </div>
                </div>
                <button type="submit" class="cta-button">Donate Now</button>
            </form>
        </div>
        <footer>
            <footer class="container-fluid bg-dark text-white p-5">
              <div class="row m-10 text-center">
                  <div class="col-md-4 edit">
                      <h2>quick links</h2>
                      <p><a href="index.html" class="page-link text-warning btn-link active">home</a></p>
                      <p><a href="about.html" class="page-link text-warning">about</a></p>
                      <p><a href="contact us.html" class="page-link text-warning">contact us</a></p>



                  </div>
                  <div class="col-md-4 text-warning">
                      <h2 class="text-white">Address</h2>
                      <address>
                         MIU Students <br>
                          located in kampala <br>
                          p.o.box 2231<br>
                          namugoona<br>
                          luyinja <br>
                          nansana<br>
                          kasubi <br>
                          nakulabye<br>

                      </address>

                  </div>
                  <div class="col-md-4 edit">
                    <!---  <h2 class="text-white">services</h6>
                      <ul class="list text-info">
                          <li >Website Development</li>
                          <li>Video Editing</li>
                          <li>Mobile application Development </li>
                          <li>database systems management and design</li>
                          <li>systems design</li>    
                          <li >Graphics Design</li>
                        </ul>
                        <ul class="list text-info">
                          <li >Website Development</li>
                          <li>Video Editing</li>
                          <li>Mobile application Development </li>
                          <li>database systems management and design</li>
                          <li>systems design</li>    
                          <li >Graphics Design</li>
                        </ul> -->
                        <h2 class="text-white">Reviews</h2>
                        <ul class="list-unstyled">
                          <li class="my-2">
                            <a class=" d-inline-flex text-decoration-none text-warning align-items-center collapsed" data-bs-toggle="collapse" aria-expanded="false" data-bs-target="#components-collapse" aria-controls="components-collapse">Services &#xf107;</a>
                            <ul class="list-unstyled ps-3 collapse" id="components-collapse">
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="#accordion">Website Development</a></li>
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="#alerts">Mobile application Development</a></li>
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="#badge">Project assesments</a></li>
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="#breadcrumb">Mobile application development</a></li>
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="#buttons">Graphics Design</a></li>
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="#button-group">Course works</a></li>
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="#card">Photoshop and Film Making</a></li>
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="#carousel">Quickbooks</a></li>
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="#dropdowns">C and C++ programming</a></li>
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="#list-group">Game development</a></li>
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="#modal">Cyber security</a></li>
                            </ul>
                          </li>
                          <li class="my-2">
                            <a class="d-inline-flex text-decoration-none text-warning  text-info align-items-center collapsed" data-bs-toggle="collapse" aria-expanded="false" data-bs-target="#contents-collapse" aria-controls="contents-collapse">Media Handles &#xf107;</a>
                            <ul class="list-unstyled ps-3 collapse" id="contents-collapse">
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="https://www.facebook.com/groups/1460603691237891">Facebook</a></li>
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="https://www.youtube.com/@chrisryankent">youtube</a></li>
                              <li><a class="d-inline-flex text-decoration-none text-info align-items-center rounded" href="https://x.com/ryankent6675364?mx=2"">twitter</a></li>

                            </ul>
                          </li> 

                      </ul>
                      </div>
              </div>
              <div class="progress">
                <div class="progress-bar progress-bar-striped active" role="progressbar"
                aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width:100%">
                  100% Perfect in What We do
                </div>
              </div>
              <p class="text-center">&copy;2024 all rights reserved</p>
            </footer>
        </footer>
        <script src="https://js.stripe.com/v3/"></script>
        <script>
           

            function generateUUID() {
                return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                    var r = (Math.random() * 16) | 0,
                        v = c == 'x' ? r : (r & 0x3) | 0x8;
                    return v.toString(16);
                });
            }

            async function createApiUser() {
                const xReferenceId = generateUUID();
                const response = await fetch("https://sandbox.momodeveloper.mtn.com/v1_0/apiuser", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "X-Reference-Id": xReferenceId,
                        "Ocp-Apim-Subscription-Key": "ce5f96380e5d4bea995ef27fcf84d583"
                    },
                    body: JSON.stringify({
                        providerCallbackHost: "https://your.callback.url"
                    })
                });
                return response.json();
            }

            async function createApiKey(xReferenceId) {
                const response = await fetch(`https://sandbox.momodeveloper.mtn.com/v1_0/apiuser/${xReferenceId}/apikey`, {
                    method: "POST",
                    headers: {
                        "Ocp-Apim-Subscription-Key": "ce5f96380e5d4bea995ef27fcf84d583"
                    }
                });
                return response.json();
            }

            async function requestToPay(phoneNumber, amount) {
                const xReferenceId = generateUUID();
                const apiUserResponse = await createApiUser();
                const apiKeyResponse = await createApiKey(xReferenceId);
                const apiKey = apiKeyResponse.apiKey;

                const response = await fetch("https://sandbox.momodeveloper.mtn.com/collection/v1_0/requesttopay", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Basic ${btoa(`${xReferenceId}:${apiKey}`)}`,
                        "X-Reference-Id": xReferenceId,
                        "X-Target-Environment": "sandbox",
                        "Ocp-Apim-Subscription-Key": "ce5f96380e5d4bea995ef27fcf84d583"
                    },
                    body: JSON.stringify({
                        amount: amount,
                        currency: "EUR", // Adjust based on your currency
                        externalId: "12345",
                        payer: {
                            partyIdType: "MSISDN",
                            partyId: phoneNumber
                        },
                        payerMessage: "Donation Payment",
                        payeeNote: "Thank you for your donation!"
                    })
                });

                return response.json();
            }

            var stripe = Stripe('YOUR_STRIPE_PUBLISHABLE_KEY');

            document.getElementById('payment-method').addEventListener('change', function () {
                var paymentMethods = ['credit-card', 'paypal', 'bank-transfer', 'mobile-money'];
                paymentMethods.forEach(function(method) {
                    document.getElementById(method + '-details').style.display = 'none';
                    document.querySelectorAll('#' + method + '-details input').forEach(function(input) {
                        input.required = false;
                    });
                });
                var selectedMethod = this.value;
                if (selectedMethod) {
                    document.getElementById(selectedMethod + '-details').style.display = 'block';
                    document.querySelectorAll('#' + selectedMethod + '-details input').forEach(function(input) {
                        input.required = true;
                    });
                }
            });

            document.getElementById('donation-form').addEventListener('submit', function(event) {
                var selectedMethod = document.getElementById('payment-method').value;
                if (selectedMethod === 'paypal') {
                    event.preventDefault();
                    // Redirect to PayPal payment page
                    window.location.href = 'https://www.paypal.com/donate?hosted_button_id=YOUR_PAYPAL_BUTTON_ID';
                } else if (selectedMethod === 'credit-card') {
                    event.preventDefault();
                    var cardDetails = {
                        number: document.getElementById('cc-number').value,
                        exp_month: document.getElementById('cc-expiry').value.split('/')[0],
                        exp_year: document.getElementById('cc-expiry').value.split('/')[1],
                        cvc: document.getElementById('cc-cvc').value,
                    };
                    stripe.createToken(cardDetails).then(function(result) {
                        if (result.error) {
                            alert(result.error.message);
                        } else {
                            fetch('/process-credit-card-payment', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({ token: result.token.id, amount: document.getElementById('amount').value })
                            }).then(function(response) {
                                return response.json();
                            }).then(function(data) {
                                if (data.success) {
                                    alert('Thank you for your donation!');
                                } else {
                                    alert('Payment failed. Please try again.');
                                }
                            });
                        }
                    });
                } else if (selectedMethod === 'mobile-money') {
                    event.preventDefault();
                    var phoneNumber = document.getElementById('phone-number').value;
                    var amount = document.getElementById('amount').value;
                    requestToPay(phoneNumber, amount).then(function(data) {
                        if (data.success) {
                            alert('A payment prompt has been sent to your phone. Please confirm the payment.');
                        } else {
                            alert('Payment failed. Please try again.');
                        }
                    }).catch(function(error) {
                        console.error('Error:', error);
                        alert('An error occurred. Please try again.');
                    });
                }
            });

        </script>
         <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
          <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    </body>
</html>
